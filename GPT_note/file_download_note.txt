âœ… ç¬¬ä¸€éƒ¨åˆ†ï¼šStringIO() vs BytesIO()
ğŸ”¹ ä»€éº¼æ˜¯ StringIOï¼Ÿ

    StringIO() æ˜¯ Python çš„ä¸€å€‹è¨˜æ†¶é«”ä¸­æ–‡æœ¬ç·©è¡å€ï¼ˆæ¨¡æ“¬æª”æ¡ˆï¼‰ã€‚

    å®ƒæœƒã€Œæ¨¡æ“¬ä¸€å€‹æ–‡å­—æª”æ¡ˆã€ï¼Œä½ å¯ä»¥å°å®ƒ .write() æ–‡å­—è³‡æ–™ï¼Œæœ€å¾Œç”¨ .getvalue() æŠŠæ‰€æœ‰å…§å®¹å–å‡ºã€‚

    ğŸ“„ é©åˆç”¨ä¾†å„²å­˜ ç´”æ–‡å­—ï¼Œåƒæ˜¯ .csvï¼ˆé€—è™Ÿåˆ†éš”å€¼ï¼‰é€™ç¨®æ ¼å¼ã€‚

ğŸ”¹ ä»€éº¼æ˜¯ BytesIOï¼Ÿ

    BytesIO() å‰‡æ˜¯æ¨¡æ“¬ä½å…ƒçµ„ï¼ˆbytesï¼‰æª”æ¡ˆã€‚

    åƒ Excelã€åœ–ç‰‡ã€PDF ç­‰é€™äº›äºŒé€²ä½æª”æ¡ˆæ ¼å¼éƒ½ä¸èƒ½ç”¨æ–‡å­—æ–¹å¼è™•ç†ï¼Œå› æ­¤éœ€è¦ç”¨ BytesIO()ã€‚

ğŸ§ª ç°¡å–®é¡æ¯”ï¼ˆå¹«åŠ©è¨˜æ†¶ï¼‰ï¼š
é¡å‹	é¡åˆ¥	é©ç”¨å ´æ™¯
StringIO	æ–‡å­—è³‡æ–™	CSVã€ç´”æ–‡å­—å ±è¡¨
BytesIO	äºŒé€²ä½è³‡æ–™	Excelã€åœ–ç‰‡ã€PDF ç­‰
âœ… ç¬¬äºŒéƒ¨åˆ†ï¼šcsv.writer(output) æ˜¯åšä»€éº¼ï¼Ÿ

é€™æ®µç¨‹å¼ï¼š

output = StringIO()
writer = csv.writer(output)

ç­‰æ–¼åœ¨èªªï¼š

    ã€Œæˆ‘ä¸å¯«é€²å¯¦é«”ç¡¬ç¢Ÿçš„æª”æ¡ˆï¼Œè€Œæ˜¯æŠŠ CSV æ ¼å¼çš„è³‡æ–™å¯«é€²è¨˜æ†¶é«”è£¡çš„ StringIOã€‚ã€

é€™æ¨£å¯«å®Œå¾Œå†ç”¨ï¼š

output.getvalue()

å°±èƒ½å–å¾—ã€Œæ•´ä»½ CSV æ–‡å­—å…§å®¹ã€ï¼Œæº–å‚™çµ¦ä½¿ç”¨è€…ä¸‹è¼‰ã€‚
âœ… ç¬¬ä¸‰éƒ¨åˆ†ï¼šCSV èˆ‡ EXCEL çš„ä¸‹è¼‰æ–¹å¼ç‚ºä½•ä¸åŒï¼Ÿ
å…§å®¹é¡å‹	ä½¿ç”¨æ–¹å¼	èªªæ˜
CSV	Response(output.getvalue())	ç›´æ¥æŠŠæ–‡å­—è³‡æ–™è®Šæˆç¶²é å›æ‡‰ï¼Œè¨­å®š MIME ç‚º text/csv
Excel	send_file(output)	Excel æ˜¯äºŒé€²ä½æ ¼å¼ï¼Œéœ€è¦é€é send_file å‚³é€ BytesIO() è³‡æ–™
ğŸ” é—œéµå·®åˆ¥ï¼š

    Response() é©åˆè™•ç†æ–‡å­—ã€‚

    send_file() æ‰èƒ½è™•ç†ã€Œæª”æ¡ˆæ ¼å¼ã€ï¼ˆå¦‚åœ–ç‰‡ã€Excelã€PDF ç­‰äºŒé€²ä½æª”æ¡ˆï¼‰ã€‚

âœ… å°æŠ„æ•´ç†

# CSV åŒ¯å‡ºï¼ˆç´”æ–‡å­—ï¼‰
from io import StringIO
output = StringIO()
writer = csv.writer(output)
writer.writerow(["æ¬„ä½1", "æ¬„ä½2"])
response = Response(output.getvalue(), content_type="text/csv")
response.headers["Content-Disposition"] = "attachment; filename=data.csv"
return response

# Excel åŒ¯å‡ºï¼ˆäºŒé€²ä½ï¼‰
from io import BytesIO
output = BytesIO()
wb.save(output)
output.seek(0)
return send_file(output, as_attachment=True, download_name="data.xlsx",
                 mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")